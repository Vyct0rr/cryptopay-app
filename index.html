<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CryptoPay</title>
    <style>
        /* CORE STYLES */
        :root { --primary: #4F46E5; --bg: #F3F4F6; --card-bg: #ffffff; --text-main: #1F2937; --text-sub: #6B7280; --border: #E5E7EB; --success: #10B981; --danger: #EF4444; --gold: #F59E0B; }
        body.dark-mode { --bg: #111827; --card-bg: #1F2937; --text-main: #F9FAFB; --text-sub: #9CA3AF; --border: #374151; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: var(--bg); color: var(--text-main); padding-bottom: 90px; height: 100vh; overflow: hidden; }
        
        /* UTILITIES */
        .flex { display: flex; } .justify-between { justify-content: space-between; } .items-center { align-items: center; }
        .p-4 { padding: 16px; } .mb-4 { margin-bottom: 16px; } .text-center { text-align: center; }
        .font-bold { font-weight: 700; } .text-xl { font-size: 1.25rem; } .text-sm { font-size: 0.875rem; }
        .text-gray { color: var(--text-sub); } .text-success { color: var(--success); } .text-gold { color: var(--gold); }
        .hidden { display: none !important; }

        /* HEADER & NAV */
        header { background: var(--card-bg); padding: 15px 20px; position: sticky; top: 0; z-index: 10; display: flex; justify-content: space-between; border-bottom: 1px solid var(--border); align-items: center; }
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: var(--card-bg); display: flex; justify-content: space-around; padding: 12px 0; border-top: 1px solid var(--border); z-index: 20; }
        .nav-item { display: flex; flex-direction: column; align-items: center; font-size: 0.75rem; color: var(--text-sub); text-decoration: none; }
        .nav-item.active { color: var(--primary); }
        .nav-icon { font-size: 1.4rem; margin-bottom: 4px; }
        .back-btn { font-size: 1.5rem; margin-right: 15px; cursor: pointer; color: var(--text-main); }

        /* COMPONENTS */
        .card { background: var(--card-bg); border-radius: 16px; padding: 20px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); margin-bottom: 15px; border: 1px solid var(--border); }
        .btn { border: none; padding: 14px 20px; border-radius: 12px; font-weight: 600; cursor: pointer; width: 100%; font-size: 1rem; margin-top: 10px; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-outline { border: 1px solid var(--border); background: var(--card-bg); color: var(--text-sub); }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 8px; font-size: 0.9rem; color: var(--text-sub); }
        .input-field { width: 100%; padding: 14px; border: 1px solid var(--border); border-radius: 12px; font-size: 1rem; outline: none; background: var(--bg); color: var(--text-main); }
        .select-field { width: 100%; padding: 14px; border: 1px solid var(--border); border-radius: 12px; font-size: 1rem; background: var(--card-bg); color: var(--text-main); }

        /* TABS */
        .tab-group { display: flex; margin-bottom: 20px; background: var(--bg); padding: 4px; border-radius: 12px; }
        .tab-btn { flex: 1; padding: 10px; border-radius: 10px; text-align: center; font-size: 0.8rem; font-weight: 600; cursor: pointer; color: var(--text-sub); transition:0.2s; }
        .tab-btn.active { background: var(--card-bg); color: var(--primary); box-shadow: 0 2px 4px rgba(0,0,0,0.05); }

        /* HOME SPECIFIC */
        .balance-card { background: linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%); color: white; text-align: center; padding: 35px 20px; border-radius: 24px; margin-bottom: 25px; }
        .balance-amount { font-size: 2.5rem; font-weight: 800; margin: 10px 0; }
        .recent-tx-item { display: flex; justify-content: space-between; padding: 14px 0; border-bottom: 1px solid var(--border); cursor: pointer; }

        /* SCREENS & MODALS */
        #splash-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--primary); z-index: 500; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; transition: opacity 0.5s; }
        #login-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--primary); color: white; z-index: 300; display: none; flex-direction: column; align-items: center; justify-content: center; }
        #app-container { height: 100%; overflow-y: auto; display: none; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 100; display: none; justify-content: center; align-items: flex-end; }
        .modal-sheet { background: var(--card-bg); width: 100%; padding: 25px; border-radius: 24px 24px 0 0; animation: slideUp 0.3s ease; max-height: 85vh; overflow-y: auto; color: var(--text-main); }
        @keyframes slideUp { from {transform: translateY(100%);} to {transform: translateY(0);} }

        /* PIN UI */
        .logo-bounce { font-size: 3rem; animation: bounce 2s infinite; margin-bottom: 20px; }
        @keyframes bounce { 0%, 20%, 50%, 80%, 100% {transform: translateY(0);} 40% {transform: translateY(-20px);} 60% {transform: translateY(-10px);} }
        .pin-dot { width: 15px; height: 15px; border: 2px solid rgba(255,255,255,0.5); border-radius: 50%; margin: 0 10px; transition: 0.2s; }
        .pin-dot.filled { background: white; border-color: white; }
        .keypad { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-top: 40px; }
        .key { width: 70px; height: 70px; border-radius: 50%; background: rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

    <div id="splash-screen"><div class="logo-bounce">üíé</div><h1 class="font-bold text-xl">CryptoPay</h1></div>

    <div id="login-screen">
        <div style="font-size:2rem; font-weight:bold; margin-bottom:10px">CryptoPay</div>
        <p style="opacity:0.8; margin-bottom:30px">Enter PIN (1234)</p>
        <div style="display:flex; margin-bottom:20px"><div class="pin-dot" id="p1"></div><div class="pin-dot" id="p2"></div><div class="pin-dot" id="p3"></div><div class="pin-dot" id="p4"></div></div>
        <div class="keypad">
            <div class="key" onclick="pressKey(1)">1</div><div class="key" onclick="pressKey(2)">2</div><div class="key" onclick="pressKey(3)">3</div>
            <div class="key" onclick="pressKey(4)">4</div><div class="key" onclick="pressKey(5)">5</div><div class="key" onclick="pressKey(6)">6</div>
            <div class="key" onclick="pressKey(7)">7</div><div class="key" onclick="pressKey(8)">8</div><div class="key" onclick="pressKey(9)">9</div>
            <div class="key"></div><div class="key" onclick="pressKey(0)">0</div><div class="key" onclick="clearPin()">‚å´</div>
        </div>
    </div>

    <div id="app-container">
        <header>
            <div class="flex items-center">
                <div id="back-btn" class="back-btn hidden" onclick="router('home')">‚Üê</div>
                <div class="font-bold text-xl">CryptoPay</div>
            </div>
            <div class="flex items-center gap-3">
                <div onclick="openProfile()" style="width:35px; height:35px; background:#E0E7FF; border-radius:50%; display:flex; align-items:center; justify-content:center; color:var(--primary); font-weight:bold; cursor:pointer;">JD</div>
            </div>
        </header>

        <main id="app-content" class="p-4"></main>

        <nav class="bottom-nav">
            <a href="#" class="nav-item active" onclick="router('home')"><span class="nav-icon">üè†</span>Home</a>
            <a href="#" class="nav-item" onclick="router('pay')"><span class="nav-icon">üì±</span>Pay</a>
            <a href="#" class="nav-item" onclick="router('send')"><span class="nav-icon">üí∏</span>Send</a>
            <a href="#" class="nav-item" onclick="router('swap')"><span class="nav-icon">üîÑ</span>Swap</a>
            <a href="#" class="nav-item" onclick="router('wallet')"><span class="nav-icon">üíº</span>Wallet</a>
        </nav>
    </div>

    <div id="receive-modal" class="modal-overlay" onclick="if(event.target===this) this.style.display='none'"><div class="modal-sheet"><h2 class="font-bold text-center mb-4">Receive</h2><div class="tab-group"><div class="tab-btn active" id="tr-c" onclick="switchRecv('crypto')">Crypto</div><div class="tab-btn" id="tr-f" onclick="switchRecv('fiat')">Fiat</div></div><div id="r-crypto"><div class="input-group"><label>Asset</label><select class="select-field"><option>USDC</option><option>BTC</option></select></div><div class="card text-center"><p class="text-xs text-gray">Address</p><div class="font-bold text-sm bg-gray-100 p-2 rounded">0x71C...39A</div></div><button class="btn btn-primary" onclick="alert('Copied')">Copy</button></div><div id="r-fiat" class="hidden"><div class="card bg-gray-900 text-white"><div class="text-xs opacity-70">Virtual Account</div><div class="text-xl font-bold my-2">8123456789</div><div class="flex justify-between text-xs"><span>Wema Bank</span><span>John Doe</span></div></div><button class="btn btn-primary" onclick="alert('Copied')">Copy</button></div></div></div>

    <div id="receipt-modal" class="modal-overlay" style="align-items:center;"><div class="modal-sheet text-center"><div style="font-size:4rem">‚úÖ</div><h2 class="font-bold text-xl">Success!</h2><p id="receipt-msg" class="text-gray mt-4"></p><button class="btn btn-primary mt-4" onclick="closeReceipt()">Done</button></div></div>

    <div id="profile-modal" class="modal-overlay" onclick="if(event.target===this) this.style.display='none'"><div class="modal-sheet"><h2 class="font-bold">John Doe</h2><button class="btn btn-outline mt-4" onclick="localStorage.clear();location.reload()">Reset App</button></div></div>

    <script>
        // --- STARTUP ---
        window.onload = function() {
            setTimeout(() => {
                document.getElementById('splash-screen').style.opacity = '0';
                setTimeout(() => { document.getElementById('splash-screen').style.display = 'none'; document.getElementById('login-screen').style.display='flex'; }, 500);
            }, 2000);
        };

        // --- AUTH ---
        let pin=""; function pressKey(n){ if(pin.length<4){pin+=n;upUI();} if(pin.length===4)setTimeout(()=>{if(pin==="1234"){document.getElementById('login-screen').style.display='none';document.getElementById('app-container').style.display='block';}else{alert("PIN: 1234");pin="";upUI();}},100); }
        function clearPin(){pin=pin.slice(0,-1);upUI();} function upUI(){for(let i=1;i<=4;i++)document.getElementById('p'+i).className=i<=pin.length?"pin-dot filled":"pin-dot";}

        // --- STATE ---
        const defState = { wallets: {NGN:25000, USDC:100}, rates:{USDC_NGN:1450}, history:[] };
        let state = JSON.parse(JSON.stringify(defState));
        try{const s=localStorage.getItem('cp_state_v13'); if(s)state=JSON.parse(s);}catch(e){}
        function save(){localStorage.setItem('cp_state_v13',JSON.stringify(state));}

        // --- ROUTER ---
        function router(s) {
            document.getElementById('app-content').innerHTML = '';
            
            // Back Button Logic
            if(s === 'home') document.getElementById('back-btn').classList.add('hidden');
            else document.getElementById('back-btn').classList.remove('hidden');

            document.querySelectorAll('.nav-item').forEach(e=>e.classList.remove('active'));
            const n = document.querySelector(`.nav-item[onclick="router('${s}')"]`);
            if(n) n.classList.add('active');

            if(s==='home') renderHome(); else if(s==='pay') renderPay(); else if(s==='send') renderSend('internal'); else if(s==='swap') renderSwap(); else if(s==='wallet') renderWallet();
        }

        // --- RENDERERS ---
        function renderHome() {
            const tot = state.wallets.USDC + (state.wallets.NGN/state.rates.USDC_NGN);
            document.getElementById('app-content').innerHTML = `
                <div class="balance-card">
                    <div class="text-sm" style="opacity:0.9">Total Net Worth</div>
                    <div class="balance-amount">$${tot.toFixed(2)}</div>
                    <div class="text-sm">‚âà ‚Ç¶${((tot*state.rates.USDC_NGN)).toLocaleString(undefined,{maximumFractionDigits:0})}</div>
                </div>
                <div class="text-center text-xs text-gray mb-4" style="background:var(--card-bg); padding:5px 15px; border-radius:20px; width:fit-content; margin: -15px auto 20px auto; border:1px solid var(--border)">
                    Rate: 1 USD = ‚Ç¶${state.rates.USDC_NGN.toLocaleString()}
                </div>
                <div class="action-grid">
                    <a class="action-btn" onclick="router('send')"><span style="font-size:1.5rem">üì§</span><span class="font-bold text-sm">Send</span></a>
                    <a class="action-btn" onclick="openRecv()"><span style="font-size:1.5rem">üì•</span><span class="font-bold text-sm">Receive</span></a>
                    <a class="action-btn" onclick="router('pay')"><span style="font-size:1.5rem">üßæ</span><span class="font-bold text-sm">Pay</span></a>
                </div>
                <h3 class="font-bold mb-2">Recent Activity</h3>
                ${state.history.length ? state.history.map(t=>`<div class="recent-tx-item"><div><div class="font-bold">${t.type}</div><div class="text-xs text-gray">${t.desc}</div></div><div class="font-bold ${t.amt.includes('-')?'text-danger':'text-success'}">${t.amt}</div></div>`).join('') : '<div class="text-center text-gray p-4">No activity yet</div>'}
            `;
        }

        function renderSend(mode) {
            let form = '';
            if(mode === 'internal') {
                form = `<div class="card"><p class="text-xs text-success font-bold mb-2">‚ö° FREE Transfer</p><div class="input-group"><label>Username</label><input type="text" id="int-user" class="input-field" placeholder="@username"></div><div class="input-group"><label>Amount (USDC)</label><input type="number" id="int-amt" class="input-field"></div><button class="btn btn-primary" onclick="doInternal()">Send Free</button></div>`;
            } else if(mode === 'crypto') {
                form = `<div class="card"><div class="input-group"><label>Asset</label><select class="select-field"><option>USDC</option><option>BTC</option></select></div><div class="input-group"><label>Wallet Address</label><input type="text" id="ext-addr" class="input-field" placeholder="0x..."></div><div class="input-group"><label>Amount</label><input type="number" id="ext-amt" class="input-field"></div><div class="text-xs text-gray mt-2 flex justify-between"><span>Fee:</span><span>$1.00</span></div><button class="btn btn-primary mt-4" onclick="doCrypto()">Send Crypto</button></div>`;
            } else if(mode === 'bank') {
                form = `<div class="card"><div class="input-group"><label>Bank</label><select class="select-field"><option>GTBank</option><option>OPay</option></select></div><div class="input-group"><label>Account</label><input type="tel" id="bank-acct" class="input-field" placeholder="10 Digits" oninput="checkName()"></div><div id="b-name" class="hidden text-success font-bold text-sm mb-2">‚úì Emeka Johnson</div><div class="input-group"><label>Amount (NGN)</label><input type="number" id="bank-amt" class="input-field"></div><div class="text-xs text-gray mt-2 flex justify-between"><span>Fee:</span><span>‚Ç¶50</span></div><button class="btn btn-primary mt-4" onclick="doBank()">Transfer</button></div>`;
            }

            document.getElementById('app-content').innerHTML = `
                <h2 class="font-bold text-xl mb-4">Send</h2>
                <div class="tab-group">
                    <div class="tab-btn ${mode==='internal'?'active':''}" onclick="renderSend('internal')">Internal</div>
                    <div class="tab-btn ${mode==='crypto'?'active':''}" onclick="renderSend('crypto')">Crypto</div>
                    <div class="tab-btn ${mode==='bank'?'active':''}" onclick="renderSend('bank')">Bank</div>
                </div>
                ${form}
            `;
        }
        
        function renderWallet() { document.getElementById('app-content').innerHTML = `<h2 class="font-bold text-xl mb-4">Assets</h2><div class="card flex justify-between items-center mb-2"><div><div class="font-bold">üá≥üá¨ NGN</div></div><div class="font-bold">‚Ç¶${state.wallets.NGN.toLocaleString()}</div></div><div class="card flex justify-between items-center mb-2"><div><div class="font-bold">üá∫üá∏ USDC</div></div><div class="font-bold">$${state.wallets.USDC.toFixed(2)}</div></div>`; }
        function renderPay() { document.getElementById('app-content').innerHTML = `<h2 class="font-bold text-xl mb-4">Pay</h2><div class="card text-center p-4">Scan QR üì∑</div>`; }
        function renderSwap() { document.getElementById('app-content').innerHTML = `<h2 class="font-bold text-xl mb-4">Swap</h2><div class="card"><div class="input-group"><label>From (NGN)</label><input type="number" class="input-field" id="sw-amt" oninput="calcSw()"></div><div class="text-center">‚¨áÔ∏è</div><div class="input-group"><label>To (USDC)</label><input type="text" class="input-field" id="sw-out" disabled></div><button class="btn btn-primary mt-4" onclick="doSwap()">Swap</button></div>`; }

        // --- ACTIONS ---
        function checkName() { if(document.getElementById('bank-acct').value.length===10) document.getElementById('b-name').classList.remove('hidden'); else document.getElementById('b-name').classList.add('hidden'); }
        function doInternal() { const a=parseFloat(document.getElementById('int-amt').value); if(!a||a>state.wallets.USDC)return alert("Invalid/Low Funds"); state.wallets.USDC-=a; addTx("Internal",`To ${document.getElementById('int-user').value}`,`-$${a}`); showReceipt("Sent!"); }
        function doCrypto() { const a=parseFloat(document.getElementById('ext-amt').value); const tot=a+1; if(!a||tot>state.wallets.USDC)return alert("Invalid/Low Funds"); state.wallets.USDC-=tot; addTx("Crypto Out",`Ext Transfer`,`-$${a}`); showReceipt("Sent!"); }
        function doBank() { const a=parseFloat(document.getElementById('bank-amt').value); const tot=a+50; if(!a||tot>state.wallets.NGN)return alert("Invalid/Low Funds"); state.wallets.NGN-=tot; addTx("Bank Transfer",`To Emeka`,`-‚Ç¶${a}`); showReceipt("Sent!"); }
        function doSwap() { const a=parseFloat(document.getElementById('sw-amt').value); if(!a||a>state.wallets.NGN)return alert("Invalid"); const r=(a*0.99)/state.rates.USDC_NGN; state.wallets.NGN-=a; state.wallets.USDC+=r; addTx("Swap","NGN to USDC",`+$${r.toFixed(2)}`); showReceipt("Swapped!"); }
        function calcSw() { const a=parseFloat(document.getElementById('sw-amt').value); if(a) document.getElementById('sw-out').value=((a*0.99)/state.rates.USDC_NGN).toFixed(2); }

        function openRecv() { document.getElementById('receive-modal').style.display='flex'; switchRecv('crypto'); }
        function switchRecv(t) { if(t==='crypto'){document.getElementById('tr-c').classList.add('active');document.getElementById('tr-f').classList.remove('active');document.getElementById('r-crypto').classList.remove('hidden');document.getElementById('r-fiat').classList.add('hidden');}else{document.getElementById('tr-f').classList.add('active');document.getElementById('tr-c').classList.remove('active');document.getElementById('r-fiat').classList.remove('hidden');document.getElementById('r-crypto').classList.add('hidden');} }

        function addTx(t, d, a) { state.history.unshift({type:t, desc:d, amt:a}); save(); }
        function showReceipt(m) { document.getElementById('receipt-msg').textContent=m; document.getElementById('receipt-modal').style.display='flex'; }
        function closeReceipt() { document.getElementById('receipt-modal').style.display='none'; router('home'); }
        function openProfile() { document.getElementById('profile-modal').style.display='flex'; }

        setTimeout(() => router('home'), 100);
    </script>
</body>
</html>
